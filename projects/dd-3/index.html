<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">DD-3 | ez robotics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/projects/dd-3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="DD-3 | ez robotics"><meta data-rh="true" name="description" content="DD-3 is a Star Wars inspired fully functional droid. Built with personality in mind, DD-3 uses automation to give servos life and make DD-3 into a convincing character."><meta data-rh="true" property="og:description" content="DD-3 is a Star Wars inspired fully functional droid. Built with personality in mind, DD-3 uses automation to give servos life and make DD-3 into a convincing character."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-11-30T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://roboticsisez.com"><meta data-rh="true" property="article:tag" content="hardware,software,cad,electrical,star wars,wip"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/projects/dd-3"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/projects/dd-3" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/projects/dd-3" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/projects/rss.xml" title="ez robotics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/projects/atom.xml" title="ez robotics Atom Feed"><link rel="stylesheet" href="/assets/css/styles.107cd0da.css">
<script src="/assets/js/runtime~main.7768e6d5.js" defer="defer"></script>
<script src="/assets/js/main.7fb60855.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">robotics is ez</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/projects">Projects</a><a href="https://ez-robotics.github.io/EZ-Template/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">EZ-Template Docs</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">About</a><a href="https://github.com/EZ-Robotics" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All My Projects</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/projects/dd-3">DD-3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/adaptive-pid">Adaptive PID</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/spraypaint-booth">Spraypaint Booth</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/french-cleats">French Cleats</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/about-ez-template">EZ-Template</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/pure-pursuit">Pure Pursuit</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/the-pushbot">The Pushbot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/supernova-spectacular-awards">Supernova Spectacular Awards</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/preload-disc-holder">Preload Disc Holder</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/about-ez-gui">EZ GUI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/harvard-westlake-blz-i">Harvard-Westlake- BLZ-i</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/vexcode-tutorials">VEXcode Tutorials</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/dave">Dave</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/esd-board-case">Printable ESD Board Case</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/harvard-westlake-amogo-dogo">Harvard-Westlake- AMOGO x DOGO</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/vex-cadding-tutorials">VEX CADing Tutorials</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/vex-change-up">Ooga Booga &amp; Frank</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/goofy-ri3d">Goofy - Robot in 3 Days</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/keke">Turning Point - Keke</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/spoonwars">Spoon Wars</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/pancake">Turning Point - Pancake</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/middle-in-the-zone">Middle of In the Zone</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/rerun">Rerun</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/minecraft-plugin-core">Minecraft Plugin - Core</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/nerf-destiny">Destiny Nerf Blaster</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/projects/nerf-mavshot">Mavshot Nerf Blaster</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="DD-3 is a Star Wars inspired fully functional droid. Built with personality in mind, DD-3 uses automation to give servos life and make DD-3 into a convincing character."><header><h1 class="title_f1Hy" itemprop="headline">DD-3</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-11-30T00:00:00.000Z" itemprop="datePublished">November 30, 2023</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://roboticsisez.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/Unionjackjz1.png" alt="Jess Zarchi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://roboticsisez.com" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jess Zarchi</span></a></div><small class="avatar__subtitle" itemprop="description">Roboticist</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>DD-3 is a Star Wars inspired fully functional droid. Built with personality in mind, DD-3 uses automation to give servos life and make DD-3 into a convincing character.</p>
<p>Build log, from the start.  Click <code>Read More</code>!</p>
<p><img loading="lazy" src="/assets/images/banner-b2078b35e25271fc31097ac379c3c028.jpg" width="3024" height="4032" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d-o">D-O<a href="#d-o" class="hash-link" aria-label="Direct link to D-O" title="Direct link to D-O">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This section is WIP</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="open-sauce-2023">Open Sauce 2023<a href="#open-sauce-2023" class="hash-link" aria-label="Direct link to Open Sauce 2023" title="Direct link to Open Sauce 2023">​</a></h2>
<p>I didn&#x27;t work on this project for ~3 weeks after it ate my finger.  The next time I was running it, I needed to implement safeties to stop something like that from happening.</p>
<p>At Open Sauce I saw some self-balancing robots that used the same mpu6050 that I was trying to balance with which gave me more confidence that I could pull off what I was trying to pull off.</p>
<p>I also ran into the R2 Builders booth and discussed it with <a href="https://www.curiousmarc.com/home" target="_blank" rel="noopener noreferrer">CuriousMarc</a>.  I remember watching his YouTube videos back in ~2016, it was very cool to meet him.  He let me look inside the droid and we spoke for a bit.  He told me to start simple before jumping into a larger project like an R2. I realized then I had to simplify this project to get it done and making the entire project rely on something I wasn&#x27;t 100% sure would work as well as I hoped was concerning.</p>
<p>I started looking into drawings of droids and stumbled across this which feels so perfect.  It has the D-O tire but adds arms, and the body looks like an R2 but the head is a BB-8.  It seems perfect, and this became my reference photo for simplifying the project.
<img loading="lazy" src="/assets/images/dd3_sketch-bd468cbc499e61a11316c22fa93e61c2.png" width="1920" height="1069" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="long-beach-comic-con-2023">Long Beach Comic Con 2023<a href="#long-beach-comic-con-2023" class="hash-link" aria-label="Direct link to Long Beach Comic Con 2023" title="Direct link to Long Beach Comic Con 2023">​</a></h2>
<p>I saw there was a convention on September 2 and 3 and decided to sign up.  This would be my deadline for getting the robot presentable.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This section is WIP</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="oc-maker-faire-2023">OC Maker Faire 2023<a href="#oc-maker-faire-2023" class="hash-link" aria-label="Direct link to OC Maker Faire 2023" title="Direct link to OC Maker Faire 2023">​</a></h2>
<p>Goal: October 21 2023</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="plans">Plans<a href="#plans" class="hash-link" aria-label="Direct link to Plans" title="Direct link to Plans">​</a></h3>
<p>With everything I learned talking to the other droid builders at Long Beach Comic Con, I decided to sand back paint on every part and redo them. The highest priority for me was to go to the next con with the robot working.  Here&#x27;s my priority list:</p>
<ul>
<li>redoing the wiring, double check everything, adding speakers</li>
<li>repaint everything</li>
<li>practice traveling with the robot to make sure it works after travel</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redoing-wiring">Redoing Wiring<a href="#redoing-wiring" class="hash-link" aria-label="Direct link to Redoing Wiring" title="Direct link to Redoing Wiring">​</a></h3>
<p>I was pretty tired of breaking things and had help from Kiana Dumdumaya to make sure everything was being done correctly.</p>
<p>The first thing she did was make a Google Sheet with every component and connections between them, which I think is genius and super simple.
<img loading="lazy" src="/assets/images/droid_wiring-1d634adefff9f4cb897532f21ac5ae44.png" width="1769" height="736" class="img_ev3q"></p>
<p>Kiana was much more methodical about testing everything than I had been.  I would look up how to connect a component and immediately solder it together, and test as I went.  Kiana made sure everything worked through a breadboard before making any connections and soldering after.  This process made me realize that my frustration with electronics is just my lack of methodology as I have with software and hardware.
<img loading="lazy" src="/assets/images/breadboard-76c3d5bafa96d7600def6cff1145c15b.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>An improvement we wanted to make to the wiring was to use SBUS instead of PWM on the receiver.  The receiver has 8 PWM pins, using them means we only have 8 channels from the transmitter to read and 8 pins on the Arduino get used.  SBUS is a serial protocol that can contain all of the channels on the transmitter and would only take UART on the Arduino.<br>
<img loading="lazy" src="/assets/images/frsky_receiver-b605f29c7f4160949105edbd29fcd075.png" width="565" height="414" class="img_ev3q"></p>
<p>This required making a serial inverter so the Arduino could read it, but after that, everything worked seamlessly with an <a href="https://github.com/bolderflight/sbus" target="_blank" rel="noopener noreferrer">sbus library</a>.  We found <a href="https://www.ernstc.dk/arduino/sbus.html" target="_blank" rel="noopener noreferrer">this page</a> which had a schematic for a serial inverter for SBUS.
<img loading="lazy" src="/assets/images/serial_onverter-f29e11f9b3bc71987653d041ae69e932.jpg" width="582" height="331" class="img_ev3q"></p>
<p>I brought the robot to work to see if everything would work after packing it in the case and traveling with it.  I had a hiccup where my joystick inputs weren&#x27;t doing anything, but I figured this would have been a problem with the on/off switch as that&#x27;s the only thing that would stop the joysticks from moving.  I checked and a wire was unplugged from the Arduino, and everything worked after that!</p>
<iframe width="315" height="560" src="https://youtube.com/embed/IsVxDqDYuvk?si=QfPQhgxrZzTwgiFX" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
<p>I wanted to get speakers working for this event, but I couldn&#x27;t get it to work in time.  The audio quality was terrible from PWM on the Arduino, and there wasn&#x27;t time to get a better solution.  Audio will have to wait.</p>
<p>I tried getting the communication between body and head Arduino to work, but I had a few problems.  The serial port on my Arduino was now being used for SBUS, and the software serial library made by Arduino wasn&#x27;t working in my case and was causing the servos to stutter.  Even with that, as I was testing somehow the Arduino in the head shorted, it got extremely hot and wasn&#x27;t responsive to anything.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="repainting-everything">Repainting Everything<a href="#repainting-everything" class="hash-link" aria-label="Direct link to Repainting Everything" title="Direct link to Repainting Everything">​</a></h3>
<p>At Long Beach Comic-Con, I asked the other builders how they finished their 3D prints to not look printed.  The suggestions were to:</p>
<ol>
<li>sand a lot before putting anything on, get rid of layer lines, and make it smooth</li>
<li>use a filler, bondo spot putty, or filler primer</li>
<li>sand the primer back to smooth everything out</li>
<li>check if it needs another layer of primer/bondo and another sanding, repeat as needed</li>
</ol>
<p>We also discussed how green isn&#x27;t a Star Wars color.  And after I was told the green looked like guacamole, I wasn&#x27;t feeling it.  So I decided to go to more of a yellow similar to the original reference drawing.</p>
<p>I experimented on a small decorative piece on the leg, and focusing on step 1 to avoid a &quot;garbage in, garbage out&quot; scenario worked amazing.  Green is before, yellow is after.
<img loading="lazy" src="/assets/images/green_original-6d711a643fb1f7fb2248da9f12d239c3.jpg" width="3024" height="4032" class="img_ev3q">
<img loading="lazy" src="/assets/images/yellow_test-086e24a0f289f17bae398aeb84302121.jpg" width="3024" height="4032" class="img_ev3q"></p>
<p>With the amount I was going to be painting, I wanted a better solution to doing everything outside.  I built a ventilated spray paint booth, which I also have a project page on.
<img loading="lazy" src="/assets/images/spraypaint_booth-25a9f8cba5d54bd397d1f82d86d2f2c3.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>I started this for some of the larger parts to get the worst of it over with, sanding takes forever.  After realizing how important the initial first step is, I paid more attention to it.  After sanding I&#x27;d fill holes with bondo and sand it back.  I&#x27;d also mix bondo and acetone to get a consistency of thick paint so I could cover large areas.  Doing this meant I needed to repeat the filler primer step much less.
<img loading="lazy" src="/assets/images/sanding_more_parts-5c72eb775f93ee0ec905a2d0fa0b3f5b.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>The finish I could get was much better now.
<img loading="lazy" src="/assets/images/og_vs_sanded-83447be8d0a84fbe41dc1db2d2784abb.jpg" width="4032" height="3024" class="img_ev3q">
<img loading="lazy" src="/assets/images/post_filler_primer-eb4f32b4d4ece6696045e1807a3c6679.jpg" width="4032" height="3024" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-and-fixes">Testing and Fixes<a href="#testing-and-fixes" class="hash-link" aria-label="Direct link to Testing and Fixes" title="Direct link to Testing and Fixes">​</a></h3>
<p>Because of how overkill the motors are for this project, I needed to implement a slew rate to the drive.  The goal of this is to ramp up the power being sent to the motor.  If I tell the motors to go 30%, they should ramp up to that 30%.</p>
<p>This in itself is pretty simple.  I take the speed that was set to the motor, check if it&#x27;s bigger or smaller than what we currently have, and add or subtract a constant to that number.  This loop iterates every 10ms and now we have a slew.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F2F2F2;--prism-background-color:#373737"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F2F2F2;background-color:#373737"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F2F2F2"><span class="token comment" style="color:#ff63c2;font-style:italic">// Slew the drive motors to avoid changes in motion that are too large</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> l_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> MAX </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">drive_set</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> l</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> r</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">drive_switch_enabled</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> r_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">drive_set_raw</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  l_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> l</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  r_target </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> max </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fmax</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-=</span><span class="token plain"> l_add</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> l_add</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-=</span><span class="token plain"> r_add</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_current </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> r_add</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token function" style="color:hsl(207, 82%, 66%)">drive_set_raw</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_current</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_current</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A problem that I noticed after driving with this code is driving in arcs felt wrong.  If I drove in an arc, where the left side would go at 30 power and the right side at 15, both sides would increase at the same rate until the slower side hit 15.  So the robot would drive forward and then turn, even though I never told it to go forward.</p>
<p>I solved this by scaling the slower side down by the ratio of <code>slower side / faster side</code> with this code and everything felt significantly better.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F2F2F2;--prism-background-color:#373737"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F2F2F2;background-color:#373737"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> max </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fmax</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> min </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fmin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">min </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> max</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">l_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">r_target</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    l_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">min </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> max</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    r_add </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> MAX</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I wanted to change the sensitivity of the joysticks, so I added the same joystick curve I&#x27;ve been using on my VEX robots which I explain <a href="https://ez-robotics.github.io/EZ-Template/tutorials/joystick_curve" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>But the drive still felt strange.  It can&#x27;t point turn nicely because it has 4 wheels that don&#x27;t slide well.  There is some code in FRC called curvature drive which is single-stick arcade but makes the robot feel like a typical RC car.  One axis is forward / backward, and the other axis controls &quot;the angle the front wheels are facing&quot; but in code.  With the implementation I&#x27;m using I can&#x27;t point turn anymore, but I couldn&#x27;t before anyway so that doesn&#x27;t bother me.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F2F2F2;--prism-background-color:#373737"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F2F2F2;background-color:#373737"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Curvature Drive from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token comment" style="color:#ff63c2;font-style:italic">// https://github.com/OkapiLib/OkapiLib/blob/54995fd390aaf4d4949a516a76580c50b394912f/src/api/chassis/model/skidSteerModel.cpp#L140-L169</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> scale </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> max_speed</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> forward </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_curve_fwd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_channel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">LEFT_Y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> curve_fwd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">127.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> curve </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_curve_turn</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_channel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">LEFT_X</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> curve_turn</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">127.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> left_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> forward </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">forward</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> curve</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> right_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> forward </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">forward</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> curve</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token comment" style="color:#ff63c2;font-style:italic">// normalizes output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> faster_side </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fmax</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">left_speed</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">fabs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_speed</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">faster_side </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    left_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/=</span><span class="token plain"> faster_side</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    right_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/=</span><span class="token plain"> faster_side</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  left_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> left_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> scale</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  right_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> right_speed </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> scale</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is a seam between both halves of the body and this always bothered me.  I was going to try to make a strip that goes up along the seam so it&#x27;s covered by something that looks like an intentional vertical line.</p>
<p>Kiana suggested instead of that to just have something that wraps around the body and squeezes it all together.  I was skeptical because of the strange geometry of that part of the body, but after she drew this image I felt like it was worth it.
<img loading="lazy" src="/assets/images/drawn_seam_fixer-26e7de61b2e5be1431a3f8d50c83e7b1.png" width="1158" height="872" class="img_ev3q">
<img loading="lazy" src="/assets/images/real_seam_fixer-a1dd77ab1f7920d0dc374a5b95e1f284.jpg" width="3024" height="4032" class="img_ev3q"></p>
<p>I finished up the pelican case and added spots for the batteries and the controller.
<img loading="lazy" src="/assets/images/bottom_case-598c1d47ea1b8839fa8465f91c346298.jpg" width="4032" height="3024" class="img_ev3q">
<img loading="lazy" src="/assets/images/middle_case-ac954f83eaff4605906a9a38d49f00e3.jpg" width="4032" height="3024" class="img_ev3q">
<img loading="lazy" src="/assets/images/top_case-29f0057f58fe54de3ffea9a058a5b063.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>I wanted to bring it to work again to make sure everything was still working, and good thing I did.  I was having a strange issue where the switch wasn&#x27;t working again, but this time everything seemed like it was plugged in.  At this point there had been 2 problems with the switch, so after work, I reprogrammed the switch to be on the controller instead.  I brought it back to work the next day and everything was working perfectly. I added safety so that when the switch goes from disabled to enabled, nothing turns on for 3 seconds.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="at-the-event">At the Event<a href="#at-the-event" class="hash-link" aria-label="Direct link to At the Event" title="Direct link to At the Event">​</a></h3>
<p><img loading="lazy" src="/assets/images/banner-b2078b35e25271fc31097ac379c3c028.jpg" width="3024" height="4032" class="img_ev3q"></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QHBAFHdF71U?si=WKsknEyCu6PMA-Uy" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
<p><img loading="lazy" src="/assets/images/r2_bully-6d64903d4b18d4e95010b23ea80c029d.jpg" width="3024" height="4032" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="la-comic-con-2023">LA Comic Con 2023<a href="#la-comic-con-2023" class="hash-link" aria-label="Direct link to LA Comic Con 2023" title="Direct link to LA Comic Con 2023">​</a></h2>
<p>Goal: December 2, 2023</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="plans-1">Plans<a href="#plans-1" class="hash-link" aria-label="Direct link to Plans" title="Direct link to Plans">​</a></h3>
<p>There is a lot I&#x27;d like to change to the robot, but I can only give it so much time.  This is the priority list for changes I&#x27;d like to make, and we&#x27;ll get to as many as we can:</p>
<ul>
<li>use gyros in the controller to decide when the controller is set down and disable the robot if it&#x27;s set down for too long</li>
<li>fix the anything that broke after it drove off of a table</li>
<li>wire the head servos to the body</li>
<li>stop controller &quot;activity warning&quot; and brushless ESC&#x27;s beeping when left alone for too long</li>
<li>redo the entire head tilt for a delta linkage</li>
<li>change ring gear for a wheel that&#x27;s sprung into a track for longevity when kids try to spin the head</li>
<li>speakers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="controller-afk-shutoff">Controller AFK Shutoff<a href="#controller-afk-shutoff" class="hash-link" aria-label="Direct link to Controller AFK Shutoff" title="Direct link to Controller AFK Shutoff">​</a></h3>
<p>I want the robot to turn itself off when I set the controller down, but only sometimes.  When the eye/eyebrows are fully done, I&#x27;d like to be able to leave the robot on and let everything animate on its own.</p>
<p>There is a switch on the controller to disable all head movement, and there&#x27;s a switch on the controller to disable the drive.  If the drive is left on I want the robot to disable when I set the controller down.  But if the drive is off, nothing should turn off when I set the controller down.</p>
<p>I don&#x27;t want the robot to turn off while I&#x27;m using the joysticks, even if the robot is completely still.  Currently, I only check if the joysticks have been used recently and allow this function to run when they haven&#x27;t, but I need to add every input on the controller to that list.  So only after no input has been touched for X amount of time will we start checking for the controller being set down.</p>
<p>Then we check the position over time (velocity) of the controller to see if it&#x27;s sitting.  If it is, a timer starts, and after that amount of time has passed the robot will shut off.</p>
<p>This needs a little less sensitivity to moving.  Currently, if the controller is on a table and someone walks nearby the controller thinks it&#x27;s moving.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F2F2F2;--prism-background-color:#373737"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F2F2F2;background-color:#373737"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Disable drive if the controller is set down for a certain amount of time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">controller_switch_output </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">are_joysticks_running</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Current values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> cur_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_channel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GYRO_X</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> cur_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">joystick_channel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GYRO_Y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Figure out the velocity of the controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> cur_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> last_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> cur_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> last_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Give wiggle room for noise</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// x = abs(x) &lt;= 1 ? 0 : x;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// y = abs(y) &lt;= 1 ? 0 : y;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    last_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> cur_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    last_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> cur_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token comment" style="color:#ff63c2;font-style:italic">// If X and Y velocity are 0, and either X or Y isn&#x27;t currently at 0 degrees, start the timer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span class="token plain"> y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">cur_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">!=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">||</span><span class="token plain"> cur_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">!=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">      afk_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">20</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">      afk_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    afk_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token comment" style="color:#ff63c2;font-style:italic">// Once the timer has reached 2000, disable everything on the robot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">afk_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2000</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    controller_switch_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    startup_switch_output </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    last_switch_state </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    controller_switch_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    afk_timer </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F2F2F2"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fixing-the-fall">Fixing the Fall<a href="#fixing-the-fall" class="hash-link" aria-label="Direct link to Fixing the Fall" title="Direct link to Fixing the Fall">​</a></h3>
<p>First, everything comes apart...
<img loading="lazy" src="/assets/images/PXL_20231122_210748901-847144cb787d731312a51eeb2ab3fb29.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>All of the damage went to the head.  A lot of mechanical parts that were hot glued on have fallen off, and some paint is chipped all around the eye.</p>
<p>I&#x27;m starting by hot-gluing everything back into place.  It&#x27;s a pretty gross process, it isn&#x27;t leading to consistency between both eyebrows which are meant to be the same.  The eye is a mess too- I saw another builder use springs instead of wire so nothing breaks when it&#x27;s hit, and that&#x27;s something I&#x27;d like to use.</p>
<p>After fixing everything mechanically it&#x27;s shown me how unhappy I am with the construction of the head.  After this event, I need to find a better solution to my problems with it.  Maybe it&#x27;s 3D printing a new head, or it&#x27;s just making entire subsystems that are printed and get hot glued in, instead of relying on hot glue to index everything inside the head. Who could have guessed that would be inconsistent?</p>
<p>Some paint scratched too.  I have two options for repairing scratches, I can either repaint it and continuously try to keep it perfect, or I can repair it and over time this will gain natural weathering.  I&#x27;m going to fix it over time.  The front yellow plate fell off during the fall and the eye took a big scratch, exposing bondo spot putty that was used to fill some gaps.
<img loading="lazy" src="/assets/images/eye_before-2ad168f5c521873581c4f44c764db938.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>The color isn&#x27;t an exact match, but it&#x27;s hard to tell that my black acrylic paint was more matte than the rest of the head because the yellow part acts as a barrier.
<img loading="lazy" src="/assets/images/eye_after-fd7a06547aac2e7092c77aa9909fafb0.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>The body cracked a little at some weaker points in the design.  There isn&#x27;t much scratched on the body though.
<img loading="lazy" src="/assets/images/boyd_before-f5c59ed49680012a5be1a37b7c7b13a5.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>I filled the parts that did scratch with some yellow paint and filled the vent with a lighter gray on the inside and gold around.  I like the idea of yellow exposing itself when the black scratches.
<img loading="lazy" src="/assets/images/body_after-9378da8abbdc4cbd8d0afd1ff2aab7f3.jpg" width="4032" height="3024" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wiring-head-servos-to-the-body">Wiring Head Servos to the Body<a href="#wiring-head-servos-to-the-body" class="hash-link" aria-label="Direct link to Wiring Head Servos to the Body" title="Direct link to Wiring Head Servos to the Body">​</a></h3>
<p>I tried to find a place to plug the servos into the servo board but the pins on the servo board are completely inaccessible.  The opposite side of the blue board needs to be reached.
<img loading="lazy" src="/assets/images/PXL_20231122_222634312-31b5894ee099de9ee2e1befd4351f9e4.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>Where this looks from the other side.
<img loading="lazy" src="/assets/images/PXL_20231122_222628747-b5d92e00a686e631ed88f0c0f0567c3f.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>The only solution I could come up with was to remove the servo board, desolder some pins, and flip them to the other side, which worked out.  Now to add wires the polycarbonate just has to be removed.
<img loading="lazy" src="/assets/images/flipped_pins-109ab6112c9b82ce987f3c187b90f9ee.jpg" width="4032" height="3024" class="img_ev3q"></p>
<p>Then it&#x27;s just wiring everything together and labeling all the wires.
<img loading="lazy" src="/assets/images/head_wired-2822ab3579660126f215a0253311f38b.jpg" width="3024" height="4032" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automated-animations">Automated Animations<a href="#automated-animations" class="hash-link" aria-label="Direct link to Automated Animations" title="Direct link to Automated Animations">​</a></h3></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/hardware">hardware</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/software">software</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/cad">cad</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/electrical">electrical</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/star-wars">star wars</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/projects/tags/wip">wip</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/projects/adaptive-pid"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Adaptive PID</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#d-o" class="table-of-contents__link toc-highlight">D-O</a></li><li><a href="#open-sauce-2023" class="table-of-contents__link toc-highlight">Open Sauce 2023</a></li><li><a href="#long-beach-comic-con-2023" class="table-of-contents__link toc-highlight">Long Beach Comic Con 2023</a></li><li><a href="#oc-maker-faire-2023" class="table-of-contents__link toc-highlight">OC Maker Faire 2023</a><ul><li><a href="#plans" class="table-of-contents__link toc-highlight">Plans</a></li><li><a href="#redoing-wiring" class="table-of-contents__link toc-highlight">Redoing Wiring</a></li><li><a href="#repainting-everything" class="table-of-contents__link toc-highlight">Repainting Everything</a></li><li><a href="#testing-and-fixes" class="table-of-contents__link toc-highlight">Testing and Fixes</a></li><li><a href="#at-the-event" class="table-of-contents__link toc-highlight">At the Event</a></li></ul></li><li><a href="#la-comic-con-2023" class="table-of-contents__link toc-highlight">LA Comic Con 2023</a><ul><li><a href="#plans-1" class="table-of-contents__link toc-highlight">Plans</a></li><li><a href="#controller-afk-shutoff" class="table-of-contents__link toc-highlight">Controller AFK Shutoff</a></li><li><a href="#fixing-the-fall" class="table-of-contents__link toc-highlight">Fixing the Fall</a></li><li><a href="#wiring-head-servos-to-the-body" class="table-of-contents__link toc-highlight">Wiring Head Servos to the Body</a></li><li><a href="#automated-animations" class="table-of-contents__link toc-highlight">Automated Animations</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://ez-robotics.github.io/EZ-Template/" target="_blank" rel="noopener noreferrer" class="footer__link-item">EZ-Template</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.instagram.com/roboticsisez" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">About Me</a></li><li class="footer__item"><a href="https://github.com/EZ-Robotics" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 robotics is ez - built with docusaurus</div></div></div></footer></div>
</body>
</html>